<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=9" />
	<title id="title">Roctopus</title>
	<HTA:APPLICATION ID="oHTA" VERSION="1.0.0.20" APPLICATIONNAME="Roctopus Salient.VMS.SUT" BORDER="Dialog" CAPTION="Yes" SHOWINTASKBAR="Yes" SINGLEINSTANCE="Yes" SYSMENU="Yes" WINDOWSTATE="Normal" SCROLL="No" SCROLLFLAT="No" INNERBORDER="No" SELECTION="No" MAXIMIZEBUTTON="No" MINIMIZEBUTTON="Yes" NAVIGABLE="Yes" CONTEXTMENU="Yes" />

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script language="javascript" type="text/javascript">
		title.innerHTML += " " + oHTA.version;

	</script>
	<style>
		
		* {
			margin: 0;
			padding: 0;
		 }
		
		.container {
			height: 100vh;
			position: relative;	
		}
		
		.container:before {
			content: "";
			position: absolute;
			background-image: url("https://www.salientsys.com/assets/uploads/images/hero.png");
			opacity: 0.5;
			left: 0;
			top: 0;
			right: 0;
			bottom: 0;
			z-index: 1;
		}
		
		.content {
			position: relative; 
			z-index: 2;
		}
		
		body {
			font-family: Arial;
		}
		
		table th {
			background-color: #E74D3D;
			color: aliceblue;
		}
		
		tbody tr:nth-child(even) {
			background-color: #F2F2F2;
		}
		
		tbody tr:nth-child(odd) {
			background-color: #FFFFFF;
		}

	</style>


</head>

<body>
	<div class="container">
		<div class="content">
			<center>
				<table>
					<thead>
						<tr>
							<th>#</th>
							<th>Sever Model</th>
							<th>Computer name</th>
							<th>OS</th>
							<th>Arch.</th>
							<th>IP address</th>
							<th>Password</th>
							<th>Status</th>
							<th></th>
						</tr>
					</thead>

					<tbody id="tableBody">
					</tbody>

				</table>
			</center>
		</div>
	</div>
</body>


<script language="javascript" type="text/javascript">
	var architecture = {
		x64: "x64",
		x32: "x32"
	};

	var os = {
		v2008: "Server 2008",
		v2012: "Server 2012",
		v7: "7",
		v8: "8",
		v81: "8.1",
		v10: "10"
	};

	function RemoteMachine(sServerModel, sComputerName, sOS, sArchitecture, sIP) {
		RemoteMachine.Count++;

		this.index = RemoteMachine.Count;
		this.serverModel = sServerModel;
		this.computerName = sComputerName;
		this.username = "Administrator";
		this.os = sOS;
		this.architecture = sArchitecture;
		this.ip = sIP;

		var id = RemoteMachine.Count - 1;
		this.htmlProperties = {
			index: this.index,
			serverModel: this.serverModel,
			computerName: "<b>" + this.computerName + "</b>",
			os: this.os,
			architecture: this.architecture,
			ip: '<a href="javascript:remoteDesktop(' + id + ')" title="remote in">' + this.ip + '<\a>',
			txtBoxPassword: '<input id="password' + id + '" type="password" />',
			status: "",
			btnRun: '<button onClick="run(' + id + ')">Run</button>'
		};
	}
	// Static property.
	RemoteMachine.Count = 0;

	var remoteMachines = [
		new RemoteMachine("PowerProR", "WIN-HOHNKC8JBI8", os.v2012, architecture.x64, "172.18.0.100"),
		new RemoteMachine("PowerPro", "QA-POWERPRO-RB", os.v7, architecture.x64, "172.18.0.101"),
		new RemoteMachine("PowerProR", "DESKTOP-HHC3INQ", os.v10, architecture.x64, "172.18.0.102"),
		new RemoteMachine("RM1100", "QA_RM1100", os.v81, architecture.x64, "172.18.0.103"),
		new RemoteMachine("RM1000R9_R10XMP", "QA-RM1000", os.v7, architecture.x32, "172.18.0.104"),
		new RemoteMachine("PowerUltra", "QA_PowerUltra", os.v2008, architecture.x64, "172.18.0.120"),
		new RemoteMachine("PowerPlus", "QA-PowerPlus", os.v2008, architecture.x64, "172.18.0.121"),
		new RemoteMachine("PowerPlus", "WIN-V379E1QUSJ4", os.v2008, architecture.x64, "172.18.0.122"),
		new RemoteMachine("PowerPlus", "Win2012", os.v2012, architecture.x64, "172.18.0.123"),
	];

	for (var i = 0; i < remoteMachines.length; i++) {
		var row = tableBody.insertRow(-1);
		for (var key in remoteMachines[i].htmlProperties) {
			var cell = row.insertCell(-1);
			cell.innerHTML = remoteMachines[i].htmlProperties[key];
		}
	}

	function run(id) {
		alert(remoteMachines[id].computerName);
	}

	function remoteDesktop(id) {
		var password = document.getElementById("password" + id).value;
		if (password == "" || password == undefined) {
			alert("Please provide a password");
			return;
		}
		
		var oShell = new ActiveXObject("WScript.Shell");
		oShell.Run('cmdkey /generic:' + remoteMachines[id].computerName + ' /user:"' + remoteMachines[id].username + '" /pass:"' + password + '"');
		oShell.Run('mstsc /v:' + remoteMachines[id].computerName + ' /admin /fullscreen');

	}

</script>

<script language="vbscript" type="text/vbscript">

</script>

</html>
